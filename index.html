<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Siyasi Grid</title>

<style>
body{margin:0;font-family:Arial;background:#111;color:white}
.topbar{display:flex;justify-content:space-between;background:#222;padding:8px}
button{padding:8px;margin:4px}

.layout{display:flex;flex-wrap:wrap}
.left{flex:1;min-width:340px;padding:10px}
.right{width:260px;background:#1a1a1a;padding:10px}

.colNumbers{
display:grid;
grid-template-columns:repeat(3,60px) 20px repeat(3,60px);
gap:6px;
margin-left:30px;
margin-bottom:6px;
font-size:12px;
opacity:.8;
}

.mapRow{
display:flex;
align-items:center;
margin-bottom:6px;
}

.rowLabel{
width:24px;
text-align:center;
font-size:12px;
opacity:.8;
}

.gridRow{
display:grid;
grid-template-columns:repeat(3,60px) 20px repeat(3,60px);
gap:6px;
}

.cell{
width:60px;height:60px;
background:#333;
display:flex;
align-items:center;
justify-content:center;
cursor:pointer;
font-size:12px;
}

.cell.active{background:#2e7d32}
.road{width:20px;height:60px;background:#555}

.partyCard{
border:1px solid #555;
padding:12px;
margin:10px;
cursor:pointer
}

.hidden{display:none}

@media(max-width:700px){
.layout{flex-direction:column}
.right{width:auto}
}
</style>
</head>

<body>

<div id="partySelect">
<h2>Parti Seç</h2>

<div class="partyCard" onclick="selectParty('MS')">
Parti X — Merkez Sol — Para 100
</div>

<div class="partyCard" onclick="selectParty('MR')">
Parti Y — Merkez Sağ — Para 100
</div>

<div class="partyCard" onclick="selectParty('ASOL')">
Parti Z — Aşırı Sol — Para 100
</div>
</div>

<div id="game" class="hidden">

<div class="topbar">
<button onclick="location.reload()">Reset</button>
<div>Tur: <span id="turn">1</span></div>
<button onclick="endTurn()">Tur Bitir</button>
</div>

<div class="layout">
<div class="left">
<div id="tabs"></div>

<div class="colNumbers">
<div>1</div><div>2</div><div>3</div><div></div><div>4</div><div>5</div><div>6</div>
</div>

<div id="map"></div>

</div>

<div class="right">
<h3>Şehir Bilgisi</h3>
<div id="cityInfo"></div>
</div>
</div>

<div style="background:#222;padding:10px">
Parti: <span id="partyInfo"></span> |
Para: <span id="money"></span><br>
Yatırım:
<button onclick="invest('A')">A</button>
<button onclick="invest('B')">B</button>
<button onclick="invest('C')">C</button>
</div>

</div>

<script>
const ideOrder=["ASOL","MS","MR","ASAG"];

const cities={
A:{name:"Şehir A",pop:17,dist:{MR:35,MS:40,ASOL:10,ASAG:15},hq:false,invest:0},
B:{name:"Şehir B",pop:5,dist:{MR:45,ASAG:25,MS:20,ASOL:10},hq:false,invest:0},
C:{name:"Şehir C",pop:3,dist:{MS:55,ASAG:5,ASOL:10,MR:20},hq:false,invest:0}
};

let party=null;
let money=100;
let turn=1;
let current="A";

function selectParty(p){
party=p;
partySelect.classList.add("hidden");
game.classList.remove("hidden");
drawTabs();
drawMap();
updatePanels();
}

function drawTabs(){
tabs.innerHTML="";
["A","B","C"].forEach(k=>{
const b=document.createElement("button");
b.textContent=cities[k].name;
b.onclick=()=>{current=k;drawMap();updatePanels()};
tabs.appendChild(b);
});
}

function drawMap(){
map.innerHTML="";
const rows=["A","B","C","D","E","F"];

rows.forEach(r=>{
const rowWrap=document.createElement("div");
rowWrap.className="mapRow";

const lab=document.createElement("div");
lab.className="rowLabel";
lab.textContent=r;
rowWrap.appendChild(lab);

const row=document.createElement("div");
row.className="gridRow";

for(let c=1;c<=6;c++){
if(c===4){
const road=document.createElement("div");
road.className="road";
row.appendChild(road);
}
const d=document.createElement("div");
d.className="cell";

if(r==="C" && c===3){
d.textContent=cities[current].hq?"HQ":"C3";
}else{
d.textContent="EV";
}

d.onclick=()=>cellClick(d,r,c);
row.appendChild(d);
}

rowWrap.appendChild(row);
map.appendChild(rowWrap);
});
}

function cellClick(d,r,c){
d.classList.toggle("active");
if(r==="C" && c===3 && !cities[current].hq){
if(money<20)return alert("Para yok");
cities[current].hq=true;
money-=20;
d.textContent="HQ";
updatePanels();
}
}

function ideologyScore(i){
const dist=Math.abs(ideOrder.indexOf(i)-ideOrder.indexOf(party));
return [0.60,0.25,0.10,0.05][dist]||0.05;
}

function election(){
let total=0;
for(const k in cities){
const c=cities[k];
for(const ide in c.dist){
let base=c.dist[ide]/100*c.pop*1000000;
let v=base*ideologyScore(ide);
if(c.hq)v*=1.15;
v*=1+(c.invest*.05);
total+=v;
}
}
alert("Tahmini Oy: "+Math.floor(total).toLocaleString());
}

function invest(k){
if(money<10)return alert("Para yok");
cities[k].invest++;
money-=10;
updatePanels();
}

function endTurn(){
money-=10;
turn++;
if(turn%5===0)election();
updatePanels();
}

function updatePanels(){
partyInfo.textContent=party;
moneyEl=document.getElementById("money");
moneyEl.textContent=money;
turnEl.textContent=turn;

const c=cities[current];
cityInfo.innerHTML=`
<b>${c.name}</b><br>
Nüfus: ${c.pop} M<br>
MS %${c.dist.MS||0}<br>
MR %${c.dist.MR||0}<br>
ASOL %${c.dist.ASOL||0}<br>
ASAG %${c.dist.ASAG||0}<br>
HQ: ${c.hq?"Var":"Yok"}<br>
Yatırım: ${c.invest}
`;
}
</script>

</body>
</html>
